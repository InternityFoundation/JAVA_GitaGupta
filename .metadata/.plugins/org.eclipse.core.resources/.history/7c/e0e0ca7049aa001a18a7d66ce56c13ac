package com.basepackage.dao;
import java.util.List;
import java.sql.Connection;
import java.sql.PreparedStatement;
import com.basepackage.bean.Csv;
import com.basepackage.utility.DbConnection;



public class InsertDatabaseImpl implements InsertDatabase  {
	public void insertValue(List<Csv> csvList){ 
		try
		{
	        Connection con=new DbConnection().buildConnection();
	        String sql = "insert  into employeeInformation(EmployeeId, EmployeeName,Job_Status,DeptId,DeptName,Salary,JobLocation) "+" values(?,?,?,?,?,?,?)";
	        PreparedStatement stmt = con.prepareStatement(sql);
			// data store		
			
			for(Csv element: csvList) {	
				//insert
				stmt.setString(1, element.getEmployeeId());
				stmt.setString(2, element.getEmployeeName());
				stmt.setString(3, element.getJob_Status());
				stmt.setString(4, element.getDeptId());
	        stmt.setString(5, element.getDeptName());
			stmt.setString(6, element.getSalary());
			stmt.setString(7, element.getJobLocation());
				stmt.executeUpdate();				
			}
			System.out.println("data inserted");
		}
		catch(Exception e)
		{
			e.printStackTrace();
		}
		
    } 
} 


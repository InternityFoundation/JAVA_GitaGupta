package com.basepackage.dao;
import java.util.ArrayList;
import java.util.List;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.Statement;
import java.util.Scanner;

import com.basepackage.bean.Csv;
import com.basepackage.utility.DbConnection;



public class InsertDatabaseImpl implements InsertDatabase  {
	public void insertValue(List<Csv> csvList){ 
		try
		{
	        Connection con=new DbConnection().buildConnection();
	        String sql = "insert  into employeedetails(EmployeeId, EmployeeName,Job_Status,DeptId,DeptName,Salary,JobLocation) "+" values(?,?,?,?,?,?,?)";
	        PreparedStatement stmt = con.prepareStatement(sql);
			// data store		
			
			for(Csv element: csvList) {	
				//insert
				stmt.setInt(1, element.getEmployeeId());
				stmt.setString(2, element.getEmployeeName());
				stmt.setString(3, element.getJob_Status());
				stmt.setInt(4, element.getDeptId());
				stmt.setString(5, element.getDeptName());
				stmt.setDouble(6, element.getSalary());
				stmt.setString(7, element.getJobLocation());
				stmt.executeUpdate();				
			}
			System.out.println("data inserted");
		}
		catch(Exception e)
		{
			e.printStackTrace();
		}
		
    } 
	public void fetchValue()
	{
		try
		{
			Connection con=new DbConnection().buildConnection();
	        String sql = "select * from employeedetails where EmployeeId=201001";
	        
	        PreparedStatement stmt = con.prepareStatement(sql);
			ResultSet rs=stmt.executeQuery();
			
			String EmployeeData="";
			while(rs.next())
			{
				EmployeeData=rs.getInt(1)+":"+rs.getString(2)+":"+rs.getString(3)+":"+rs.getInt(4)+":"+rs.getString(5)+":"+rs.getDouble(6)+":"+rs.getString(7);
				System.out.println(EmployeeData);
				
				
			}
			stmt.close();
		}
			catch(Exception e)
			{
				e.printStackTrace();
			}
		
	}
	
	public void deleteValue()
	{
		try
		{
			Connection con=new DbConnection().buildConnection();
			String 
	        String sql = "delete  from employeedetails where EmployeeId=201005";
			if(Job_Status=="ADMIN" & EmployeeId==201030)
			{
				PreparedStatement stmt = con.prepareStatement(sql);
				ResultSet rs=stmt.executeQuery();
			}
		}
			catch(Exception e)
			{
				e.printStackTrace();
			}
	}
} 


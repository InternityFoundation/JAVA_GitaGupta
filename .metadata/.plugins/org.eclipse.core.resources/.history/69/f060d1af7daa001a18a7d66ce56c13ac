package com.basepackage.dao;
//import java.util.ArrayList;
import java.util.List;
import java.util.Scanner;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.util.function.BiPredicate;

import com.basepackage.bean.Csv;
import com.basepackage.utility.DbConnection;



public class InsertDatabaseImpl implements InsertDatabase  {
	public void insertValue(List<Csv> csvList){ 
		try
		{
	        Connection con=new DbConnection().buildConnection();
	        String sql = "insert  into employeedetails(EmployeeId, EmployeeName,Job_Status,DeptId,DeptName,Salary,JobLocation) "+" values(?,?,?,?,?,?,?)";
	        PreparedStatement stmt = con.prepareStatement(sql);
			// data store		
			
			for(Csv element: csvList) {	
				//insert
				stmt.setInt(1, element.getEmployeeId());
				stmt.setString(2, element.getEmployeeName());
				stmt.setString(3, element.getJob_Status());
				stmt.setInt(4, element.getDeptId());
				stmt.setString(5, element.getDeptName());
				stmt.setDouble(6, element.getSalary());
				stmt.setString(7, element.getJobLocation());
				stmt.executeUpdate();				
			}
			System.out.println("data inserted");
		}
		catch(Exception e)
		{
			e.printStackTrace();
		}
		
    } 
	public void fetchValue()
	{
		try
		{
			Connection con=new DbConnection().buildConnection();
	        String sql = "select * from employeedetails where EmployeeId=201001";
	        
	        PreparedStatement stmt = con.prepareStatement(sql);
			ResultSet rs=stmt.executeQuery();
			
			String EmployeeData="";
			while(rs.next())
			{
				EmployeeData=rs.getInt(1)+":"+rs.getString(2)+":"+rs.getString(3)+":"+rs.getInt(4)+":"+rs.getString(5)+":"+rs.getDouble(6)+":"+rs.getString(7);
				System.out.println(EmployeeData);
				
				
			}
			stmt.close();
		}
			catch(Exception e)
			{
				e.printStackTrace();
			}
		
	}
	
	public void deleteValue()
	{
		try
		{
			Connection con=new DbConnection().buildConnection();
			Scanner sc=new Scanner(System.in);
			System.out.println("PLEASE ENTER THE DETAILS FOR DELETING RECORD:");
			System.out.println("ADMIN USERNAME:");
			String userName=sc.nextLine();
			System.out.println("ADMIN USERNAME:"+userName);
			
			System.out.println("ADMIN PASSWORD:");
			int adminId=sc.nextInt();
			System.out.println("ADMIN PASSWORD:"+adminId);
			
			
			BiPredicate<String,Integer> bp =(a,b)->(a=="ADMIN" && b==201030);
			boolean checkAdmin=bp.test(userName,adminId);
			System.out.println(checkAdmin);
			String sql = "delete  from employeedetails where EmployeeId=201006";
			
			if(checkAdmin)
			{
				PreparedStatement stmt = con.prepareStatement(sql);
				
				
				 int affectedRecords = stmt.executeUpdate();
		            System.out.println("Number of deleted records:- " + affectedRecords);
		            System.out.println("RECORD DELETED");
		 
			}
			else
				System.out.println("NOT AN ADMIN");
			sc.close();
		}
				
		catch(Exception e)
		{
			e.printStackTrace();
		}
		
	}
} 

